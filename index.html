<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Myriam Thabet â€” Now Playing</title>
  <meta name="description" content="Spotify-inspired playful portfolio for Myriam Thabet." />
  <style>
    :root{
      --bg: #0b0b10;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.085);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.66);
      --faint: rgba(255,255,255,.45);
      --line: rgba(255,255,255,.10);
      --chip: rgba(255,255,255,.08);
      --shadow: 0 16px 60px rgba(0,0,0,.55);
      --accent: #1ed760;
      --accent2: #58a6ff;
      --warn: #ff5b5b;
      --radius: 18px;
      --radius2: 26px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --blur: blur(14px);
      --noise: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.10'/%3E%3C/svg%3E");
    }

    [data-mode="focus"]{
      --bg: #07080a;
      --panel: rgba(255,255,255,.05);
      --panel2: rgba(255,255,255,.07);
      --text: rgba(255,255,255,.90);
      --muted: rgba(255,255,255,.62);
      --faint: rgba(255,255,255,.40);
      --line: rgba(255,255,255,.10);
      --chip: rgba(255,255,255,.07);
      --blur: blur(10px);
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 20% 5%, rgba(30,215,96,.22), transparent 55%),
        radial-gradient(900px 500px at 85% 10%, rgba(168,85,247,.18), transparent 55%),
        radial-gradient(800px 500px at 70% 80%, rgba(88,166,255,.16), transparent 60%),
        linear-gradient(180deg, #0b0b10, #07070a 70%, #06060a);
      overflow:hidden;
    }

    body::before{
      content:"";
      position:fixed; inset:0;
      background-image: var(--noise);
      pointer-events:none;
      mix-blend-mode: overlay;
      opacity:.35;
    }

    a{ color: inherit; text-decoration: none; }

    .kbd{
      font-family: var(--mono);
      font-size: 12px;
      padding: 2px 8px;
      border: 1px solid var(--line);
      border-radius: 10px;
      color: var(--muted);
      background: rgba(255,255,255,.03);
    }

    /* Layout */
    .app{
      height: 100%;
      display:grid;
      grid-template-columns: 280px 1fr;
      grid-template-rows: 1fr 92px;
      grid-template-areas:
        "sidebar main"
        "player  player";
      gap: 12px;
      padding: 12px;
    }

    .sidebar{
      grid-area: sidebar;
      border-radius: var(--radius2);
      background: rgba(0,0,0,.35);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      overflow:hidden;
      display:flex;
      flex-direction: column;
      min-height:0;
    }

    .main{
      grid-area: main;
      border-radius: var(--radius2);
      background: rgba(0,0,0,.25);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      overflow:hidden;
      display:flex;
      flex-direction: column;
      min-height:0;
      position:relative;
    }

    .player{
      grid-area: player;
      border-radius: var(--radius2);
      background: rgba(0,0,0,.50);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      overflow:hidden;
      display:flex;
      align-items:center;
      padding: 12px 14px;
      gap: 14px;
      position:relative;
    }

    /* Sidebar content */
    .sb-top{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--line);
    }
    .brand{
      display:flex;
      align-items:center;
      gap: 10px;
      font-weight: 800;
      letter-spacing: .2px;
    }
    .dot{
      width: 12px; height:12px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(30,215,96,.10);
    }
    .brand small{
      font-weight: 600;
      color: var(--muted);
    }

    .sb-nav{
      padding: 10px 10px 6px;
      display:flex;
      flex-direction: column;
      gap: 6px;
    }
    .nav-item{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 10px 10px;
      border-radius: 14px;
      color: var(--muted);
      transition: .15s ease;
      cursor:pointer;
      user-select:none;
    }
    .nav-item:hover{
      background: var(--panel);
      color: var(--text);
      transform: translateY(-1px);
    }
    .nav-item.active{
      background: linear-gradient(90deg, rgba(30,215,96,.16), rgba(255,255,255,0));
      border: 1px solid rgba(30,215,96,.25);
      color: var(--text);
    }
    .icon{
      width: 18px; height: 18px;
      display:inline-grid;
      place-items:center;
      opacity:.95;
    }

    .sb-section-title{
      padding: 12px 14px 8px;
      color: var(--faint);
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
      display:flex;
      justify-content: space-between;
      align-items:center;
    }

    .playlists{
      padding: 0 10px 10px;
      overflow:auto;
      min-height:0;
    }
    .playlist{
      padding: 10px 10px;
      border-radius: 14px;
      display:flex;
      gap: 10px;
      align-items:center;
      cursor:pointer;
      transition:.15s ease;
      color: var(--muted);
      border: 1px solid transparent;
      position:relative;
    }
    .playlist:hover{
      background: var(--panel);
      color: var(--text);
      border-color: var(--line);
    }
    .playlist.active{
      background: linear-gradient(90deg, rgba(30,215,96,.16), rgba(255,255,255,0));
      border: 1px solid rgba(30,215,96,.25);
      color: var(--text);
    }
    .pl-art{
      width: 42px; height: 42px;
      border-radius: 12px;
      background:
        radial-gradient(circle at 30% 30%, rgba(30,215,96,.9), transparent 55%),
        radial-gradient(circle at 70% 60%, rgba(168,85,247,.8), transparent 60%),
        rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 22px rgba(0,0,0,.30);
      flex: 0 0 auto;
    }
    .pl-meta{
      display:flex;
      flex-direction: column;
      min-width:0;
      position: relative;
    }
    .pl-meta strong{
      font-size: 14px;
      color: var(--text);
      white-space:nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    /* Tooltip bubble subtitle (hover only) */
    .pl-tooltip{
      position: absolute;
      left: 0;
      top: calc(100% + 8px);
      z-index: 20;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.78);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      box-shadow: 0 18px 50px rgba(0,0,0,.55);
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45;
      width: max-content;
      max-width: 220px;
      white-space: normal;
      opacity: 0;
      transform: translateY(-4px);
      pointer-events: none;
      transition: opacity .14s ease, transform .14s ease;
    }
    .playlist:hover .pl-tooltip,
    .playlist:focus-within .pl-tooltip{
      opacity: 1;
      transform: translateY(0);
    }
    .pl-tooltip::before{
      content:"";
      position:absolute;
      left: 18px;
      top: -6px;
      width: 10px;
      height: 10px;
      transform: rotate(45deg);
      background: rgba(0,0,0,.78);
      border-left: 1px solid rgba(255,255,255,.10);
      border-top: 1px solid rgba(255,255,255,.10);
    }

    .sb-bottom{
      padding: 10px 14px 14px;
      border-top: 1px solid var(--line);
      display:flex;
      flex-direction: column;
      gap: 10px;
    }
    .hint{
      display:flex;
      align-items:center;
      gap: 8px;
      color: var(--faint);
      font-size: 12px;
      white-space:nowrap;
    }
    .sb-links{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .sb-links .btn{
      padding: 9px 10px;
      font-size: 13px;
    }

    /* Main top bar */
    .topbar{
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      background: linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.10));
    }
    .search{
      flex: 1;
      max-width: 540px;
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      transition:.15s ease;
    }
    .search:focus-within{
      border-color: rgba(30,215,96,.40);
      box-shadow: 0 0 0 5px rgba(30,215,96,.12);
      color: var(--text);
    }
    .search input{
      width:100%;
      border:0;
      outline:0;
      background: transparent;
      color: var(--text);
      font-size: 14px;
    }
    .search-btn{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      padding: 8px 10px;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 650;
      transition: .15s ease;
      height: 32px;
      line-height: 1;
    }
    .search-btn:hover{
      color: var(--text);
      background: rgba(255,255,255,.07);
    }

    .actions{
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .btn{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      padding: 10px 12px;
      border-radius: 999px;
      cursor:pointer;
      transition:.15s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      font-weight: 650;
      letter-spacing:.1px;
    }
    .btn:hover{
      transform: translateY(-1px);
      color: var(--text);
      background: rgba(255,255,255,.06);
    }
    .btn.primary{
      background: rgba(30,215,96,.16);
      border-color: rgba(30,215,96,.30);
      color: var(--text);
    }
    .btn.primary:hover{
      background: rgba(30,215,96,.24);
    }

    /* Main content */
    .content{
      padding: 16px 14px 14px;
      overflow:auto;
      min-height:0;
    }

    /* Hero v2 */
    .hero{
      border-radius: var(--radius2);
      border: 1px solid var(--line);
      background:
        radial-gradient(700px 350px at 20% 0%, rgba(30,215,96,.22), transparent 55%),
        radial-gradient(680px 320px at 80% 10%, rgba(168,85,247,.18), transparent 60%),
        rgba(255,255,255,.03);
      padding: 18px 16px;
      display:flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 14px;
      position:relative;
      overflow:hidden;
    }
    .hero-v2 .hero-left{ max-width: 860px; }

    .np-pill{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
      color: var(--muted);
      font-size: 13px;
      margin-bottom: 12px;
    }

    .np-dot{
      width: 9px; height: 9px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(30,215,96,.12);
      animation: pulse 1400ms ease-in-out infinite;
    }

    @keyframes pulse{
      0%,100%{ transform: scale(1); opacity: .9; }
      50%{ transform: scale(1.25); opacity: 1; }
    }

    .np-eq{
      width: 18px; height: 14px;
      display:flex;
      gap: 2px;
      align-items:flex-end;
    }
    .np-eq i{
      width: 3px;
      height: 4px;
      border-radius: 2px;
      background: var(--accent);
      opacity:.85;
      animation: npBounce 700ms infinite ease-in-out;
    }
    .np-eq i:nth-child(2){ animation-delay: 120ms; }
    .np-eq i:nth-child(3){ animation-delay: 240ms; }

    @keyframes npBounce{
      0%,100%{ height: 4px; }
      50%{ height: 14px; }
    }

    .hero-kicker{
      color: var(--faint);
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
      margin-bottom: 10px;
    }

    .hero-title{
      margin: 0 0 10px;
      font-size: 40px;
      line-height: 1.06;
      letter-spacing: -0.8px;
    }
    .hero-title-accent{ color: rgba(255,255,255,.86); }

    .hero-body{
      margin: 0;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.7;
      max-width: 720px;
    }

    .hero-cta{
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      margin-top: 12px;
    }

    .hero-hint{
      margin-top: 12px;
      color: var(--faint);
      font-size: 12px;
    }

    .hero-right{
      min-width: 220px;
      display:flex;
      flex-direction: column;
      gap: 10px;
      align-items:flex-end;
    }
    .mini-card{
      width: 240px;
      border-radius: var(--radius);
      border: 1px solid var(--line);
      background: rgba(0,0,0,.20);
      padding: 12px;
    }
    .mini-card h4{
      margin:0 0 6px;
      font-size: 13px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: var(--faint);
    }
    .mini-card p{
      margin:0;
      font-size: 14px;
      color: var(--muted);
      line-height: 1.5;
    }

    .section{
      margin-top: 14px;
      border-radius: var(--radius2);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      overflow:hidden;
    }
    .section-head{
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      background: rgba(0,0,0,.20);
    }
    .section-head h3{
      margin:0;
      font-size: 14px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--faint);
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .section-head .count{
      font-family: var(--mono);
      font-size: 12px;
      color: var(--faint);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      padding: 4px 8px;
      border-radius: 999px;
    }

    /* Tracklist */
    .tracks{
      width:100%;
      border-collapse: collapse;
    }
    .tracks th, .tracks td{
      padding: 10px 14px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      vertical-align: middle;
      font-size: 14px;
    }
    .tracks thead th{
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--faint);
      background: rgba(0,0,0,.16);
      position: sticky;
      top: 0;
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      z-index: 2;
    }
    .tracks tbody tr{
      cursor:pointer;
      transition: .12s ease;
    }
    .tracks tbody tr:hover{
      background: rgba(255,255,255,.04);
    }
    .tracks tbody tr.active{
      background: rgba(30,215,96,.10);
      outline: 1px solid rgba(30,215,96,.22);
    }
    .tracks .idx{
      width: 54px;
      color: var(--faint);
      font-family: var(--mono);
      font-size: 13px;
    }
    .track-title{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }
    .t-art{
      width: 38px; height: 38px;
      border-radius: 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      position:relative;
      overflow:hidden;
    }
    .t-art::before{
      content:"";
      position:absolute; inset:-20%;
      background:
        radial-gradient(circle at 30% 30%, rgba(30,215,96,.8), transparent 60%),
        radial-gradient(circle at 70% 60%, rgba(168,85,247,.65), transparent 65%);
      transform: rotate(12deg);
      opacity:.9;
    }
    .t-meta{
      display:flex;
      flex-direction: column;
      min-width:0;
    }
    .t-meta strong{
      white-space:nowrap; overflow:hidden; text-overflow: ellipsis;
    }
    .t-meta span{
      color: var(--faint);
      font-size: 12px;
      white-space:nowrap; overflow:hidden; text-overflow: ellipsis;
    }
    .dur{
      width: 80px;
      text-align:right;
      color: var(--faint);
      font-family: var(--mono);
      font-size: 13px;
    }

    /* Drawer (Case Study) */
    .drawer{
      position:absolute;
      top: 12px;
      right: 12px;
      width: min(520px, calc(100% - 24px));
      border-radius: var(--radius2);
      border: 1px solid var(--line);
      background: rgba(0,0,0,.72);
      box-shadow: 0 24px 80px rgba(0,0,0,.60);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      transform: translateY(-10px);
      opacity:0;
      pointer-events:none;
      transition: .18s ease;
      overflow:hidden;
      z-index: 50;
    }
    .drawer.open{
      transform: translateY(0);
      opacity:1;
      pointer-events:auto;
    }
    .drawer-head{
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
    }
    .drawer-head h4{
      margin:0;
      font-size: 13px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: var(--faint);
    }
    .drawer-body{
      padding: 12px 14px 14px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.55;
      max-height: 70vh;
      overflow:auto;
    }
    .drawer-close{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      padding: 8px 10px;
      border-radius: 999px;
      cursor:pointer;
      transition:.15s ease;
    }
    .drawer-close:hover{ color: var(--text); transform: translateY(-1px); }

    .kicker{
      color: var(--faint);
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
      margin: 14px 0 6px;
    }
    .bullets{
      margin: 8px 0 0;
      padding-left: 18px;
      color: var(--muted);
      line-height:1.7;
    }
    .chips{
      display:flex;
      gap: 6px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    .chip{
      font-size: 12px;
      color: var(--muted);
      background: var(--chip);
      border: 1px solid rgba(255,255,255,.08);
      padding: 4px 8px;
      border-radius: 999px;
      white-space:nowrap;
    }
    .notice{
      margin-top: 12px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      background: rgba(255,255,255,.03);
      color: var(--faint);
      font-size: 13px;
      line-height:1.6;
    }

    /* Lyrics (Spotify-style About) + highlight */
    .lyrics-wrap{ padding: 14px; }

    .lyrics-card{
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(0,0,0,.16);
      overflow:hidden;
      position: relative;
    }

    .lyrics-top{
      position: sticky;
      top: 0;
      z-index: 5;
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(0,0,0,.62), rgba(0,0,0,.20));
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .lyrics-pill{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
      color: var(--muted);
      font-size: 13px;
    }

    .lyrics-dot{
      width: 9px; height: 9px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(30,215,96,.12);
      animation: pulse 1400ms ease-in-out infinite;
    }

    .lyrics-title{ display:flex; flex-direction:column; gap: 6px; }
    .lyrics-sub{
      color: var(--faint);
      font-size: 12px;
      line-height: 1.4;
      padding-left: 2px;
    }

    .lyrics-controls{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .lyrics-body{
      max-height: 520px;
      overflow:auto;
      padding: 16px 16px 18px;
      scroll-behavior: smooth;
    }

    .lyrics-body p{
      margin: 0 0 14px;
      color: rgba(255,255,255,.44);
      font-size: 18px;
      line-height: 1.7;
      letter-spacing: -0.1px;
      transition: opacity .14s ease, transform .14s ease, color .14s ease;
      opacity: .55;
      transform: translateY(0);
    }

    .lyrics-body p.is-active{
      color: rgba(255,255,255,.92);
      opacity: 1;
      transform: translateY(-1px);
    }

    .lyrics-body p.is-near{
      color: rgba(255,255,255,.72);
      opacity: .78;
    }

    .lyrics-body p:hover{
      color: rgba(255,255,255,.92);
      opacity: 1;
    }

    .lyrics-fade-top,
    .lyrics-fade-bottom{
      position:absolute;
      left:0; right:0;
      height: 26px;
      pointer-events:none;
      z-index: 4;
    }
    .lyrics-fade-top{
      top: 56px; /* just under sticky header */
      background: linear-gradient(180deg, rgba(0,0,0,.42), rgba(0,0,0,0));
    }
    .lyrics-fade-bottom{
      bottom: 0;
      background: linear-gradient(0deg, rgba(0,0,0,.42), rgba(0,0,0,0));
    }

    .lyrics-end{
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px solid rgba(255,255,255,.08);
      color: var(--faint);
      font-family: var(--mono);
      font-size: 12px;
      text-align:center;
    }

    /* Player */
    .now{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width: 260px;
    }
    .cover{
      width: 56px; height: 56px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(circle at 30% 30%, rgba(30,215,96,.8), transparent 60%),
        radial-gradient(circle at 70% 60%, rgba(168,85,247,.65), transparent 65%),
        rgba(255,255,255,.06);
      box-shadow: 0 12px 22px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }
    .meta{
      min-width:0;
      display:flex;
      flex-direction: column;
    }
    .meta strong{
      white-space:nowrap; overflow:hidden; text-overflow: ellipsis;
      letter-spacing: -.2px;
    }
    .meta span{
      color: var(--faint);
      font-size: 12px;
      white-space:nowrap; overflow:hidden; text-overflow: ellipsis;
    }

    .controls{
      flex: 1;
      display:flex;
      flex-direction: column;
      align-items:center;
      gap: 8px;
      min-width: 260px;
    }
    .ctrl-row{
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .ctrl{
      width: 38px; height:38px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      display:grid;
      place-items:center;
      cursor:pointer;
      transition:.15s ease;
      color: var(--muted);
      user-select:none;
    }
    .ctrl:hover{ transform: translateY(-1px); color: var(--text); background: rgba(255,255,255,.06); }
    .ctrl.play{
      width: 46px; height:46px;
      background: rgba(30,215,96,.16);
      border-color: rgba(30,215,96,.30);
      color: var(--text);
    }
    .ctrl.play:hover{ background: rgba(30,215,96,.24); }

    .bar{
      width: min(640px, 100%);
      display:flex;
      align-items:center;
      gap: 10px;
      color: var(--faint);
      font-family: var(--mono);
      font-size: 12px;
    }
    .progress{
      flex: 1;
      height: 6px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      position:relative;
      overflow:hidden;
      cursor:pointer;
    }
    .progress > i{
      position:absolute; left:0; top:0; bottom:0;
      width: 35%;
      background: linear-gradient(90deg, var(--accent), rgba(255,255,255,.25));
      border-radius: 999px;
      box-shadow: 0 0 0 6px rgba(30,215,96,.12);
    }

    .right-controls{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap: 10px;
      min-width: 260px;
    }
    .vol{
      display:flex;
      align-items:center;
      gap: 10px;
      color: var(--muted);
    }
    .volbar{
      width: 120px; height: 6px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      position:relative;
      overflow:hidden;
      cursor:pointer;
    }
    .volbar i{
      position:absolute; left:0; top:0; bottom:0;
      width: 60%;
      background: rgba(255,255,255,.30);
      border-radius: 999px;
    }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 110px;
      transform: translateX(-50%) translateY(8px);
      opacity:0;
      pointer-events:none;
      transition: .18s ease;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.75);
      color: var(--text);
      padding: 10px 12px;
      box-shadow: 0 20px 70px rgba(0,0,0,.55);
      font-size: 13px;
      display:flex;
      align-items:center;
      gap: 10px;
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      z-index: 999;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(0);
    }
    .toast .bubble{
      width: 10px; height:10px; border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(30,215,96,.12);
    }

    /* Responsive */
    @media (max-width: 980px){
      body{ overflow:auto; }
      .app{
        grid-template-columns: 1fr;
        grid-template-rows: auto 1fr 92px;
        grid-template-areas:
          "sidebar"
          "main"
          "player";
      }
      .sidebar{ height: 420px; }
      .hero{ flex-direction: column; }
      .hero-right{ align-items:flex-start; }
      .mini-card{ width: 100%; }
      .now, .right-controls{ min-width: 0; }
      .bar{ width: 100%; }
      .topbar{ flex-wrap: wrap; }
      .search{ max-width: 100%; }
      .drawer{ width: calc(100% - 24px); }
    }

    /* Hide scrollbars but keep scroll */
    .content::-webkit-scrollbar, .playlists::-webkit-scrollbar, .drawer-body::-webkit-scrollbar, .lyrics-body::-webkit-scrollbar{ width: 10px; }
    .content::-webkit-scrollbar-thumb, .playlists::-webkit-scrollbar-thumb, .drawer-body::-webkit-scrollbar-thumb, .lyrics-body::-webkit-scrollbar-thumb{
      background: rgba(255,255,255,.10);
      border-radius: 999px;
      border: 2px solid rgba(0,0,0,.0);
      background-clip: padding-box;
    }
  </style>
</head>

<body data-mode="focus">
  <div class="app">
    <aside class="sidebar" aria-label="Sidebar">
      <div class="sb-top">
        <div class="brand">
          <span class="dot"></span>
          <div>
            <div>Myriam Thabet</div>
            <small>Now Playing: Portfolio</small>
          </div>
        </div>
      </div>

      <nav class="sb-nav" aria-label="Primary navigation">
        <div class="nav-item" data-jump="home">
          <span class="icon">âŒ‚</span><span>Home</span>
        </div>
        <div class="nav-item active" data-jump="about">
          <span class="icon">âœŽ</span><span>About</span>
        </div>
        <div class="nav-item" data-jump="tracks">
          <span class="icon">â™ª</span><span>Case studies</span>
        </div>
        <div class="nav-item" data-jump="contact">
          <span class="icon">âœ‰</span><span>Contact</span>
        </div>
      </nav>

      <div class="sb-section-title">
        <span>Playlists</span>
        <span class="kbd">F</span>
      </div>
      <div class="playlists" id="playlistWrap" aria-label="Playlists"></div>

      <div class="sb-bottom">
        <div class="hint">
          <span class="kbd">?</span>
          <span>shortcuts</span>
        </div>

        <div class="sb-links">
          <button class="btn primary" id="resumeBtnSide" title="Open resume (R)">Resume <span class="kbd">R</span></button>
          <a class="btn" target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/myriam-thabet-772a3a229">LinkedIn</a>
        </div>
      </div>
    </aside>

    <main class="main" aria-label="Main">
      <div class="topbar">
        <div class="search" title="Search case studies (type and hit Enter)">
          <span class="icon">âŒ•</span>
          <input id="searchInput" placeholder="Search case studiesâ€¦" aria-label="Search" />
          <button class="search-btn" id="searchBtn" title="Search">Search</button>
        </div>

        <div class="actions">
          <button class="btn primary" id="resumeBtn" title="Open resume link">
            <span>Resume</span> <span class="kbd">R</span>
          </button>
        </div>
      </div>

      <aside class="drawer" id="caseDrawer" aria-label="Case study" aria-hidden="true">
        <div class="drawer-head">
          <h4 id="caseTitle">Now Playing</h4>
          <button class="drawer-close" id="caseClose" aria-label="Close">Close</button>
        </div>
        <div class="drawer-body" id="caseBody"></div>
      </aside>

      <div class="content" id="content">
        <!-- Home Section -->
        <section class="hero hero-v2" id="home" style="margin-top:14px;">
          <div class="hero-left">
            <div class="np-pill" aria-label="Now Playing">
              <span class="np-dot" aria-hidden="true"></span>
              <span class="np-eq" aria-hidden="true"><i></i><i></i><i></i></span>
              <span><b>Now Playing</b> â€¢ Myriam Thabet</span>
            </div>

            <div class="hero-kicker">Portfolio â€¢ Machine Learning â€¢ Product-minded</div>

            <h1 class="hero-title">
              Portfolio
              <!-- <span class="hero-title-accent">from pipelines to decisions.</span> -->
            </h1>

            <p class="hero-body">
              If you ended up here, there's a good chance you already saw my resume or cover letter.
              This page is the story behind the bullet points.
            </p>

            <div class="hero-cta">
              <button class="btn primary" data-jump="about">Read the long answer</button>
              <button class="btn" data-jump="tracks">Browse case studies</button>
            </div>

            <div class="hero-hint">
              Shortcuts: <span class="kbd">Space</span> story mode â€¢ <span class="kbd">N</span> next â€¢
              <span class="kbd">P</span> previous â€¢ <span class="kbd">R</span> resume â€¢ <span class="kbd">?</span> tips
            </div>
          </div>

                </section>
        <!-- About Me Section FIRST -->
        <section class="section" id="about">
          <div class="section-head">
            <h3>About Me</h3>
            <div class="count" id="lyricsStatus">LIVE</div>
          </div>

          <div class="lyrics-wrap">
            <div class="lyrics-card">
              <div class="lyrics-top">
                <div class="lyrics-title">
                  <div class="lyrics-pill">
                    <span class="lyrics-dot" aria-hidden="true"></span>
                    <span><b>Lyrics</b> â€¢ About me</span>
                  </div>
                  <div class="lyrics-sub">Auto-scroll like Spotify. Hover or scroll to pause. Current line highlights.</div>
                </div>

                <div class="lyrics-controls">
                  <button class="btn primary" id="lyricsPlayBtn" title="Play / Pause lyrics">Auto-scroll</button>
                  <button class="btn" id="lyricsSpeedBtn" title="Change speed">1Ã—</button>
                  <button class="btn" id="lyricsTopBtn" title="Back to top">Top</button>
                </div>
              </div>

              <div class="lyrics-fade-top"></div>
              <div class="lyrics-body" id="lyricsBody" tabindex="0" aria-label="Lyrics content">

                <p>Growing up, my days already involved switching contexts. I went to a French school in Tunisia, spoke both French and Tunisian at home, and naturally slipped into Tunisian on the streets. Languages were never something I consciously "learned" at first, they were simply part of everyday life. I think that's where my interest in languages, cultures, and exploring the world quietly took root.</p>

                <p>Because of that, there's a question I've always found slightly tricky to answer. When someone asks where I'm from, I usually pause. Not because I don't know, but because there isn't one short sentence that really captures it. I never know whether to give the quick version or the longer one.</p>

                <p>I grew up between France and Tunisia, moving between different cultural reference points from an early age. That mix shaped how I think and how I approach new situations. Adapting feels natural to me, and curiosity usually takes the lead.</p>

                <p>It's a bit ironic, because I'm very comfortable with complex problems. I enjoy breaking down messy questions, thinking critically, and building solutions step by step. Yet that simple, everyday question still makes me hesitate.</p>

                <p>That background explains many of my choices later on. I moved to the Netherlands for my studies, drawn by the international environment, and eventually decided to spend an exchange semester at Korea University in Seoul. I studied AI and data science there, but a big part of the experience was learning how to live somewhere entirely new, navigating daily life in another language, and seeing familiar problems from a different angle.</p>

                <p>I enjoyed it enough to go back to Korea again later, this time specifically for language school. Living there without the exchange student bubble was a very different experience. It taught me patience, consistency, and how rewarding it can be to stay curious even when things feel unfamiliar for a while.</p>

                <p>Outside of work and studies, I love being on the move. I enjoy backpacking, wandering through cities without a plan, and taking long walks with a podcast playing in my ears. Music is a constant in my life. I play piano, I overthink playlists, and I like how sound can quietly shape a day.</p>

                <p>I've also always enjoyed being part of communities, whether through volunteering, student initiatives, or language exchanges. I'm drawn to spaces where people with different backgrounds come together and learn from each other.</p>

                <p>So if you're wondering where I'm from, this is probably the long answer. And this website is where I finally give it.</p>

                <div class="lyrics-end">â€” end â€”</div>
              </div>
              <div class="lyrics-fade-bottom"></div>
            </div>
          </div>
        </section>

        <!-- Case Studies Section -->
        <section class="section" id="tracks" style="margin-top:14px;">
          <div class="section-head">
            <h3>Case studies</h3>
            <div class="count" id="trackCount">06</div>
          </div>

          <table class="tracks" aria-label="Case study list">
            <thead>
              <tr>
                <th class="idx">#</th>
                <th>Title</th>
                <th class="dur">Time</th>
              </tr>
            </thead>
            <tbody id="trackBody">
              <tr data-track-id="1">
                <td class="idx">01</td>
                <td>
                  <div class="track-title">
                    <div class="t-art" aria-hidden="true"></div>
                    <div class="t-meta">
                      <strong>Case 01 â€” Support Ops Dashboard (End-to-End)</strong>
                      <span>APIs â†’ Airflow â†’ ClickHouse â†’ KPI choices â†’ Superset used in monthly reviews</span>
                    </div>
                  </div>
                </td>
                <td class="dur">4:10</td>
              </tr>
              <tr data-track-id="2">
                <td class="idx">02</td>
                <td>
                  <div class="track-title">
                    <div class="t-art" aria-hidden="true"></div>
                    <div class="t-meta">
                      <strong>Case 02 â€” User Clustering for Targeted Communication</strong>
                      <span>Feature engineering across sources + stakeholder scoping â†’ actionable segments</span>
                    </div>
                  </div>
                </td>
                <td class="dur">3:55</td>
              </tr>
              <tr data-track-id="3">
                <td class="idx">03</td>
                <td>
                  <div class="track-title">
                    <div class="t-art" aria-hidden="true"></div>
                    <div class="t-meta">
                      <strong>Case 03 â€” NYC Subway Ridership Forecasting</strong>
                      <span>SARIMA baseline + XGBoost improvement with structured validation</span>
                    </div>
                  </div>
                </td>
                <td class="dur">3:24</td>
              </tr>
              <tr data-track-id="4">
                <td class="idx">04</td>
                <td>
                  <div class="track-title">
                    <div class="t-art" aria-hidden="true"></div>
                    <div class="t-meta">
                      <strong>Case 04 â€” DSS for Clandestine Network Analysis</strong>
                      <span>Community detection + role identification packaged for analysts</span>
                    </div>
                  </div>
                </td>
                <td class="dur">4:02</td>
              </tr>
              <tr data-track-id="5">
                <td class="idx">05</td>
                <td>
                  <div class="track-title">
                    <div class="t-art" aria-hidden="true"></div>
                    <div class="t-meta">
                      <strong>Case 05 â€” Cardiovascular Disease Classification</strong>
                      <span>Chi-square + correlation feature selection â†’ Random Forest (73% accuracy)</span>
                    </div>
                  </div>
                </td>
                <td class="dur">3:12</td>
              </tr>
              <tr data-track-id="6">
                <td class="idx">06</td>
                <td>
                  <div class="track-title">
                    <div class="t-art" aria-hidden="true"></div>
                    <div class="t-meta">
                      <strong>Case 06 â€” Sarcasm Detection in News Headlines</strong>
                      <span>GRU/LSTM + embeddings â†’ F1 up to 0.86; minimal preprocessing worked best</span>
                    </div>
                  </div>
                </td>
                <td class="dur">3:28</td>
              </tr>
            </tbody>
          </table>

          <div style="padding: 12px 14px; color: var(--faint); font-size:12px;">
            Tip: click any row to open the deep dive panel. Use the playlists on the left to filter.
          </div>
        </section>


        <!-- Contact Section -->
        <section class="section" id="contact" style="margin-top:14px;">
          <div class="section-head">
            <h3>Contact</h3>
            <div class="count">OK</div>
          </div>
          <div style="padding: 14px;">
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div style="border:1px solid var(--line); border-radius: var(--radius2); background: rgba(0,0,0,.16); padding: 14px;">
                <div style="font-weight:850; font-size:16px;">Say hi</div>
                <p style="margin:10px 0 0; color: var(--muted); line-height:1.7;">
                  Open to conversations about applied ML, personalization-style problems, and building prototypes that survive real constraints.
                </p>
                <div style="margin-top:12px; display:flex; gap: 10px; flex-wrap: wrap;">
                  <a class="btn primary" href="mailto:thabetmyr@gmail.com">Email</a>
                  <a class="btn" target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/myriam-thabet-772a3a229">LinkedIn</a>
                </div>
                <div style="margin-top:10px; color: var(--faint); font-size:12px;">
                  Tip: press <span class="kbd">R</span> to open resume link.
                </div>
              </div>

              <div style="border:1px solid var(--line); border-radius: var(--radius2); background: rgba(0,0,0,.16); padding: 14px;">
                <div style="font-weight:850; font-size:16px;">Site controls</div>
                <ul style="margin:10px 0 0; padding-left: 18px; color: var(--muted); line-height:1.8;">
                  <li><span class="kbd">Space</span> story mode</li>
                  <li><span class="kbd">N</span> next case</li>
                  <li><span class="kbd">P</span> previous case</li>
                  <li><span class="kbd">S</span> save</li>
                  <li><span class="kbd">R</span> resume</li>
                  <li><span class="kbd">?</span> tips toast</li>
                  <li><span class="kbd">Esc</span> close drawer</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <div style="height: 18px;"></div>
      </div>
    </main>

    <footer class="player" aria-label="Player">
      <div class="now">
        <div class="cover" aria-hidden="true"></div>
        <div class="meta">
          <strong id="nowTitle">Case 01 â€” Support Ops Dashboard (End-to-End)</strong>
          <span id="nowArtist">Myriam Thabet â€¢ Selected Work</span>
        </div>
      </div>

      <div class="controls">
        <div class="ctrl-row">
          <div class="ctrl" id="prevBtn" title="Previous (P)">âŸ²</div>
          <div class="ctrl play" id="playBtn" title="Story mode (Space)">â–¶</div>
          <div class="ctrl" id="nextBtn" title="Next (N)">âŸ³</div>
          <div class="ctrl" id="likeBtn" title="Save (S)">â™¡</div>
        </div>
        <div class="bar" title="This shows the reading progress of the open case study">
          <span id="timeNow">0%</span>
          <div class="progress" id="progress"><i id="progressFill"></i></div>
          <span id="timeEnd">100%</span>
        </div>
      </div>

      <div class="right-controls">
        <div class="vol" title="Volume (cosmetic)">
          <span>ðŸ”Š</span>
          <div class="volbar" id="volbar"><i id="volFill"></i></div>
        </div>
        <button class="btn" id="contactBtn" title="Contact">Contact</button>
      </div>
    </footer>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite">
    <span class="bubble"></span>
    <span id="toastText">Hello</span>
  </div>

  <script>
    // ======================
    // Data
    // ======================
    const PLAYLISTS = [
      { key: "all",     title: "All case studies",        subtitle: "Everything worth skimming first" },
      { key: "check",   title: "Applied ML @ Check",      subtitle: "Pipelines, KPI design, dashboards, segmentation" },
      { key: "bachelor",title: "Bachelor projects",       subtitle: "Forecasting + applied modeling" },
      { key: "dss",     title: "Decision Support System", subtitle: "Network analysis & roles/factions" },
      { key: "ml",      title: "ML + NLP projects",       subtitle: "Classification and sequence models" },
    ];

    const TRACKS = [
      {
        id: 1,
        playlist: "check",
        title: "Support Ops Dashboard (End-to-End)",
        subtitle: "APIs â†’ Airflow â†’ ClickHouse â†’ KPI choices â†’ Superset used in monthly reviews",
        tags: ["pipelines", "clickhouse", "airflow", "superset", "kpis"],
        length: "4:10",
        section: "Check Technologies",
        privacy: "public",
        case: {
          problem: "Support needed a reliable monitoring view to review performance and operations consistently.",
          constraints: [
            "Metrics can mislead if definitions are vague",
            "Multiple sources (APIs + platform data)",
            "Deliverable had to be usable by managers in recurring reviews"
          ],
          approach: [
            "Gathered data from APIs and built production tables via Airflow + ClickHouse",
            "Worked with the support manager to define KPIs and challenged metric choices when they didn't match decisions",
            "Built a Superset dashboard designed around the monthly review flow (not just charts)"
          ],
          impact: [
            "Dashboard is used by managers during monthly reviews",
            "Clear KPI definitions reduced ambiguity and improved follow-up discussions"
          ],
          links: [{ label: "Resume (context)", href: "#" }]
        }
      },
      {
        id: 2,
        playlist: "check",
        title: "User Clustering for Targeted Communication",
        subtitle: "Feature engineering across sources + stakeholder scoping â†’ actionable segments",
        tags: ["clustering", "behavior", "feature engineering", "stakeholders"],
        length: "3:55",
        section: "Check Technologies",
        privacy: "public",
        case: {
          problem: "Segments were needed to explore communication targeting based on real behavior, not assumptions.",
          constraints: [
            "Behavior data is noisy and multi-modal",
            "Clusters must be interpretable to be used",
            "High risk of 'random clusters' without validation"
          ],
          approach: [
            "Engineered features by gathering data across platform sources",
            "Ran EDA to check relevance of variables and removed fragile proxies",
            "Scoped use-cases with stakeholders before locking modeling choices"
          ],
          impact: [
            "Defined clusters now being investigated for possible communication targeting",
            "Set up a repeatable workflow to iterate on features and validation"
          ],
          links: [{ label: "Resume (context)", href: "#" }]
        }
      },
      {
        id: 3,
        playlist: "bachelor",
        title: "NYC Subway Ridership Forecasting",
        subtitle: "SARIMA baseline + XGBoost improvement with structured validation",
        tags: ["time series", "sarima", "xgboost", "forecasting"],
        length: "3:24",
        section: "Bachelor thesis",
        privacy: "public",
        case: {
          problem: "Forecast ridership patterns with interpretable baselines and performance improvements.",
          constraints: [
            "Seasonality and structural changes",
            "Model comparison had to be fair and repeatable",
            "Evaluation needed to reflect forecasting reality"
          ],
          approach: [
            "Built SARIMA as a strong statistical baseline",
            "Trained XGBoost to capture nonlinearities and exogenous structure",
            "Compared models with time-aware splits and error analysis"
          ],
          impact: [
            "Produced a clear baseline vs improvement narrative",
            "Demonstrated how model choice changes decisions under uncertainty"
          ],
          links: [{ label: "Resume (context)", href: "#" }]
        }
      },
      {
        id: 4,
        playlist: "dss",
        title: "DSS for Clandestine Network Analysis",
        subtitle: "Community detection + role identification packaged for analysts",
        tags: ["networks", "dss", "communities", "roles", "evaluation"],
        length: "4:02",
        section: "VU Amsterdam",
        privacy: "public",
        case: {
          problem: "Support analysts by turning network algorithms into an interface that guides decisions.",
          constraints: [
            "Multiple algorithms give different outputs",
            "Results need validation and limits must be explicit",
            "UI must help interpretation, not just display graphs"
          ],
          approach: [
            "Integrated community detection and role identification methods",
            "Added comparison and validation signals (not just one score)",
            "Designed an interactive workflow to explore factions/roles and interpret them"
          ],
          impact: [
            "Produced a decision-support interface rather than a static analysis",
            "Made algorithm trade-offs visible for non-technical users"
          ],
          links: [{ label: "Resume (context)", href: "#" }]
        }
      },
      {
        id: 5,
        playlist: "ml",
        title: "Cardiovascular Disease Classification",
        subtitle: "Chi-square + correlation feature selection â†’ Random Forest (73% accuracy)",
        tags: ["classification", "feature selection", "random forest", "stats"],
        length: "3:12",
        section: "ML + Statistics",
        privacy: "public",
        case: {
          problem: "Predict cardiovascular disease (CVD) and identify which health features drive risk.",
          constraints: [
            "Mix of categorical/binary and continuous variables",
            "Risk of collinearity in blood pressure signals",
            "Feature selection had to be justified statistically"
          ],
          approach: [
            "Used chi-square tests (Î±=0.05) for categorical/binary variables; all were significant",
            "Used correlation analysis and kept features with â‰¥0.2 correlation to CVD",
            "Dropped diastolic BP due to collinearity and trained multiple models"
          ],
          impact: [
            "Random Forest achieved best test accuracy (73%)",
            "Top features: systolic BP, then age and cholesterol"
          ],
          links: [{ label: "Resume (context)", href: "#" }]
        }
      },
      {
        id: 6,
        playlist: "ml",
        title: "Sarcasm Detection in News Headlines",
        subtitle: "GRU/LSTM + embeddings â†’ F1 up to 0.86; minimal preprocessing worked best",
        tags: ["nlp", "lstm", "gru", "embeddings", "f1-score"],
        length: "3:28",
        section: "NLP",
        privacy: "public",
        case: {
          problem: "Detect sarcasm in news headlines (The Onion vs HuffPost) using NLP and sequence models.",
          constraints: [
            "Context cues are easy to strip during preprocessing",
            "Overfitting risk with RNN models",
            "Need a metric balancing precision/recall"
          ],
          approach: [
            "Used balanced dataset and verified data quality",
            "Built minimally processed vs fully processed pipelines",
            "Tested Word2Vec, GloVe, self-trained embeddings with GRU/LSTM and tuned hyperparameters"
          ],
          impact: [
            "Best F1 around 0.80â€“0.86; minimally processed text performed better",
            "GRU and LSTM performed similarly; embedding choice had limited impact"
          ],
          links: [{ label: "Resume (context)", href: "#" }]
        }
      },
    ];

    // ======================
    // State
    // ======================
    let currentIdx = 0;
    let storyMode = false;
    let saved = new Set();
    let progressPct = 0.0;
    let volumePct = 0.60;
    let activePlaylist = "all";
    let storyTimer = null;

    // Lyrics
    let lyricsPlaying = false;
    let lyricsSpeed = 1;
    let lyricsRAF = null;
    let userInteracting = false;
    let userInteractT = null;
    let lyricsLastT = null;


    // ======================
    // Elements
    // ======================
    const trackBody = document.getElementById("trackBody");
    const trackCount = document.getElementById("trackCount");
    const nowTitle = document.getElementById("nowTitle");
    const nowArtist = document.getElementById("nowArtist");
    const playBtn = document.getElementById("playBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const likeBtn = document.getElementById("likeBtn");

    const progress = document.getElementById("progress");
    const progressFill = document.getElementById("progressFill");
    const timeNow = document.getElementById("timeNow");
    const timeEnd = document.getElementById("timeEnd");

    const volbar = document.getElementById("volbar");
    const volFill = document.getElementById("volFill");

    const resumeBtn = document.getElementById("resumeBtn");
    const resumeBtnSide = document.getElementById("resumeBtnSide");
    const contactBtn = document.getElementById("contactBtn");
    const toast = document.getElementById("toast");
    const toastText = document.getElementById("toastText");
    const searchInput = document.getElementById("searchInput");
    const searchBtn = document.getElementById("searchBtn");

    // Drawer
    const caseDrawer = document.getElementById("caseDrawer");
    const caseTitle = document.getElementById("caseTitle");
    const caseBody  = document.getElementById("caseBody");
    const caseClose = document.getElementById("caseClose");

    // Playlists
    const playlistWrap = document.getElementById("playlistWrap");

    // Content container
    const content = document.getElementById("content");

    // Lyrics elements
    const lyricsBody = document.getElementById("lyricsBody");
    const lyricsPlayBtn = document.getElementById("lyricsPlayBtn");
    const lyricsSpeedBtn = document.getElementById("lyricsSpeedBtn");
    const lyricsTopBtn = document.getElementById("lyricsTopBtn");

    // ======================
    // Helpers
    // ======================
    function showToast(msg){
      toastText.textContent = msg;
      toast.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toast.classList.remove("show"), 1400);
    }

    function scrollToId(id){
  const el = document.getElementById(id);
  if(!el || !content) return;

  // scroll inside the content panel
  const cRect = content.getBoundingClientRect();
  const eRect = el.getBoundingClientRect();
  const top = (eRect.top - cRect.top) + content.scrollTop - 12;

  content.scrollTo({ top, behavior: "smooth" });

  // update sidebar active state
  document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
  const active = document.querySelector(`.nav-item[data-jump="${id}"]`);
  if(active) active.classList.add("active");
}


    function setVolume(p){
      volumePct = Math.max(0, Math.min(1, p));
      volFill.style.width = `${volumePct * 100}%`;
      showToast(`Volume ${Math.round(volumePct*100)}%`);
    }

    function setReadingProgress(p){
      progressPct = Math.max(0, Math.min(1, p));
      progressFill.style.width = `${progressPct * 100}%`;
      timeNow.textContent = `${Math.round(progressPct*100)}%`;
    }

    function updateSavedState(){
      const t = TRACKS[currentIdx];
      const isSaved = saved.has(t.id);
      likeBtn.textContent = isSaved ? "â™¥" : "â™¡";
      likeBtn.style.borderColor = isSaved ? "rgba(30,215,96,.45)" : "var(--line)";
      likeBtn.style.background = isSaved ? "rgba(30,215,96,.10)" : "rgba(255,255,255,.03)";
    }

    function setCurrentTrack(syncDrawer){
      const t = TRACKS[currentIdx];
      nowTitle.textContent = `Case ${String(t.id).padStart(2,"0")} â€” ${t.title}`;
      nowArtist.textContent = `Myriam Thabet â€¢ ${t.section}`;
      updateSavedState();

      document.querySelectorAll("#trackBody tr").forEach(tr => tr.classList.remove("active"));
      const activeRow = document.querySelector(`#trackBody tr[data-track-id="${t.id}"]`);
      if(activeRow) activeRow.classList.add("active");

      if(syncDrawer) openCase(t);
    }

    function openCase(t){
      caseTitle.textContent = `Now Playing â€” ${t.title}`;
      const c = t.case;

      const privacyLabel = (t.privacy === "private")
        ? `<div class="notice"><b style="color:var(--text);">Privacy note:</b> Details are intentionally kept high-level. The goal is to show how problems get framed and evaluated.</div>`
        : "";

      const links = (c.links || []).map(l =>
        `<a class="btn primary" target="_blank" rel="noreferrer" href="${l.href}">${l.label}</a>`
      ).join("");

      caseBody.innerHTML = `
        <div style="display:flex; justify-content:space-between; gap:10px; align-items:flex-start;">
          <div style="min-width:0;">
            <div style="color:var(--text); font-weight:850; letter-spacing:-.2px; font-size:16px;">${t.subtitle}</div>
            <div class="chips">${(t.tags||[]).map(x => `<span class="chip">${x}</span>`).join("")}</div>
          </div>
          <div style="flex:0 0 auto; color:var(--faint); font-family:var(--mono); font-size:12px; padding-top:4px;">${t.length}</div>
        </div>

        <div class="kicker">Problem</div>
        <div style="color:var(--muted); line-height:1.7;">${c.problem}</div>

        <div class="kicker">Constraints</div>
        <ul class="bullets">${(c.constraints||[]).map(x => `<li>${x}</li>`).join("")}</ul>

        <div class="kicker">Approach</div>
        <ul class="bullets">${(c.approach||[]).map(x => `<li>${x}</li>`).join("")}</ul>

        <div class="kicker">Outcome</div>
        <ul class="bullets">${(c.impact||[]).map(x => `<li>${x}</li>`).join("")}</ul>

        ${privacyLabel}

        <div style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap;">
          ${links}
        </div>
      `;

      caseDrawer.classList.add("open");
      caseDrawer.setAttribute("aria-hidden","false");
      setReadingProgress(0);

      requestAnimationFrame(() => {
        const el = caseBody;
        const onScroll = () => {
          const max = Math.max(1, el.scrollHeight - el.clientHeight);
          setReadingProgress(el.scrollTop / max);
        };
        el.addEventListener("scroll", onScroll, { passive: true });
        onScroll();
      });
    }
    function ensureCurrentTrackVisible(list){
      if(!list || list.length === 0) return;
      const visibleIds = new Set(list.map(t => t.id));
      const currentId = TRACKS[currentIdx]?.id;

      if(!visibleIds.has(currentId)){
        const firstId = list[0].id;
        const realIndex = TRACKS.findIndex(x => x.id === firstId);
        if(realIndex >= 0) currentIdx = realIndex;
      }
    }
    function closeCase(){
      caseDrawer.classList.remove("open");
      caseDrawer.setAttribute("aria-hidden","true");
      setReadingProgress(0);
    }

    function nextTrack(openDrawer = storyMode){
      currentIdx = (currentIdx + 1) % TRACKS.length;
      setCurrentTrack(openDrawer);
    }

    function prevTrack(openDrawer = storyMode){
      currentIdx = (currentIdx - 1 + TRACKS.length) % TRACKS.length;
      setCurrentTrack(openDrawer);
    }

    function toggleSaved(){
      const t = TRACKS[currentIdx];
      if(saved.has(t.id)) saved.delete(t.id);
      else saved.add(t.id);
      updateSavedState();
      showToast(saved.has(t.id) ? "Saved" : "Unsaved");
    }

    function updateStoryState(){
      playBtn.textContent = storyMode ? "âšâš" : "â–¶";
      showToast(storyMode ? "Story mode on" : "Story mode off");

      if(storyMode){
        clearInterval(storyTimer);
        storyTimer = setInterval(() => {
          if(!caseDrawer.classList.contains("open")){
            openCase(TRACKS[currentIdx]);
          } else {
            nextTrack(true);
          }
        }, 12000);
      } else {
        clearInterval(storyTimer);
        storyTimer = null;
      }
    }

    function renderPlaylists(){
      playlistWrap.innerHTML = "";
      PLAYLISTS.forEach(p => {
        const row = document.createElement("div");
        row.className = "playlist" + (p.key === activePlaylist ? " active" : "");
        row.dataset.playlist = p.key;

        row.innerHTML = `
          <div class="pl-art" aria-hidden="true"></div>
          <div class="pl-meta">
            <strong>${p.title}</strong>
            <span class="pl-tooltip" role="tooltip">${p.subtitle}</span>
          </div>
        `;

        row.addEventListener("click", () => {
          activePlaylist = p.key;
          document.querySelectorAll(".playlist").forEach(x => x.classList.remove("active"));
          row.classList.add("active");
          renderTracks(getVisibleTracks());
          showToast(p.key === "all" ? "Showing all" : `Filtered: ${p.title}`);
          scrollToId("tracks");
        });

        playlistWrap.appendChild(row);
      });
    }

    function getVisibleTracks(){
      if(activePlaylist === "all") return TRACKS;
      return TRACKS.filter(t => t.playlist === activePlaylist);
    }

    function renderTracks(list){
      trackBody.innerHTML = "";
      trackCount.textContent = String(list.length).padStart(2,"0");

      list.forEach((t, idx) => {
        const tr = document.createElement("tr");
        tr.dataset.trackId = t.id;

        tr.innerHTML = `
          <td class="idx">${String(idx+1).padStart(2,"0")}</td>
          <td>
            <div class="track-title">
              <div class="t-art" aria-hidden="true"></div>
              <div class="t-meta">
              <strong>Case ${String(t.id).padStart(2,"0")} â€” ${t.title}</strong>
                <span>${t.subtitle}</span>
              </div>
            </div>
          </td>
          <td class="dur">${t.length}</td>
        `;

        tr.addEventListener("click", () => {
          const realIndex = TRACKS.findIndex(x => x.id === t.id);
          if(realIndex >= 0) {
            currentIdx = realIndex;
            setCurrentTrack(true);
            showToast(`Opened: ${TRACKS[currentIdx].title}`);
          }
        });

        trackBody.appendChild(tr);
      });

      ensureCurrentTrackVisible(list);
      setCurrentTrack(false);
    }

    function doSearch(){
      const q = searchInput.value.trim().toLowerCase();
      const base = getVisibleTracks();

      if(!q){
        renderTracks(base);
        showToast(activePlaylist === "all" ? "Showing all" : "Showing filtered playlist");
        return;
      }

      const filtered = base.filter(t =>
        t.title.toLowerCase().includes(q) ||
        t.subtitle.toLowerCase().includes(q) ||
        (t.tags || []).join(" ").toLowerCase().includes(q) ||
        (t.section || "").toLowerCase().includes(q)
      );
      renderTracks(filtered);
      showToast(`${filtered.length} match(es)`);
      scrollToId("tracks");
    }

    function openResume(){
  const url = "./Resume_Thabet_Myriam.pdf"; // put the PDF in the same folder as index.html
  window.open(url, "_blank", "noopener,noreferrer");
}


    // ======================
    // Lyrics (auto-scroll + highlight)
    // ======================
    function lyricsSetBtn(){
      if(!lyricsPlayBtn || !lyricsSpeedBtn) return;
      lyricsPlayBtn.textContent = lyricsPlaying ? "Pause" : "Auto-scroll";
      lyricsSpeedBtn.textContent = `${lyricsSpeed}Ã—`;
    }

    function markUserInteracting(){
      userInteracting = true;
      clearTimeout(userInteractT);
      userInteractT = setTimeout(() => userInteracting = false, 900);
    }

    function setLyricsHighlight(){
      if(!lyricsBody) return;
      const ps = Array.from(lyricsBody.querySelectorAll("p"));
      if(!ps.length) return;

      const top = lyricsBody.getBoundingClientRect().top;
      const targetY = top + lyricsBody.clientHeight * 0.15;

      let best = null;
      let bestDist = Infinity;
      for(const p of ps){
        const r = p.getBoundingClientRect();
        const mid = r.top + r.height * 0.5;
        const d = Math.abs(mid - targetY);
        if(d < bestDist){
          bestDist = d;
          best = p;
        }
      }

      ps.forEach(p => p.classList.remove("is-active","is-near"));
      if(best){
        best.classList.add("is-active");
        const idx = ps.indexOf(best);
        if(ps[idx-1]) ps[idx-1].classList.add("is-near");
        if(ps[idx+1]) ps[idx+1].classList.add("is-near");
      }
    }

    function lyricsTick(){
      if(!lyricsPlaying || !lyricsBody) return;

      if(userInteracting){
        setLyricsHighlight();
        lyricsRAF = requestAnimationFrame(lyricsTick);
        return;
      }

    const now = performance.now();
if (lyricsLastT == null) lyricsLastT = now;
const dt = Math.min(40, now - lyricsLastT); // ms cap
lyricsLastT = now;

const px = (0.045 * dt) * lyricsSpeed; // ~0.9px at 20ms

      <!-- lyricsBody.scrollTop += px; -->

      setLyricsHighlight();

      const atEnd = (lyricsBody.scrollTop + lyricsBody.clientHeight) >= (lyricsBody.scrollHeight - 2);
      if(atEnd){
        lyricsPlaying = false;
        lyricsSetBtn();
        showToast("Lyrics reached the end");
        return;
      }

      lyricsRAF = requestAnimationFrame(lyricsTick);
    }

    function lyricsPlay(){
      if(!lyricsBody) return;
      lyricsPlaying = true;
      lyricsSetBtn();
      cancelAnimationFrame(lyricsRAF);
      lyricsRAF = requestAnimationFrame(lyricsTick);
      showToast("Lyrics auto-scroll");
    }

    function lyricsPause(){
      lyricsPlaying = false;
      lyricsSetBtn();
      cancelAnimationFrame(lyricsRAF);
      lyricsRAF = null;
      showToast("Lyrics paused");
    }

    // ======================
    // Events
    // ======================
    document.querySelectorAll("[data-jump]").forEach(el => {
      el.addEventListener("click", () => scrollToId(el.dataset.jump));
    });

    caseClose.addEventListener("click", closeCase);

    playBtn.addEventListener("click", () => {
      storyMode = !storyMode;
      updateStoryState();
    });

    nextBtn.addEventListener("click", () => nextTrack(true));
    prevBtn.addEventListener("click", () => prevTrack(true));
    likeBtn.addEventListener("click", toggleSaved);

    progress.addEventListener("click", (e) => {
      if(!caseDrawer.classList.contains("open")){
        showToast("Open a case study first");
        return;
      }
      const rect = progress.getBoundingClientRect();
      const p = (e.clientX - rect.left) / rect.width;
      const el = caseBody;
      const max = Math.max(1, el.scrollHeight - el.clientHeight);
      el.scrollTop = max * p;
    });

    volbar.addEventListener("click", (e) => {
      const rect = volbar.getBoundingClientRect();
      const p = (e.clientX - rect.left) / rect.width;
      setVolume(p);
    });

    contactBtn.addEventListener("click", () => scrollToId("contact"));

    resumeBtn.addEventListener("click", openResume);
    resumeBtnSide.addEventListener("click", openResume);

    searchBtn.addEventListener("click", doSearch);
    searchInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") doSearch();
      if (e.key === "Escape") {
        searchInput.value = "";
        renderTracks(getVisibleTracks());
        showToast("Search cleared");
      }
    });

    // Lyrics controls + pause on interaction
    lyricsLastT = null;

    lyricsPlayBtn?.addEventListener("click", () => {
      lyricsPlaying ? lyricsPause() : lyricsPlay();
    });

    lyricsSpeedBtn?.addEventListener("click", () => {
      const cycle = [1, 1.5, 2, 0.75];
      const i = cycle.indexOf(lyricsSpeed);
      lyricsSpeed = cycle[(i + 1) % cycle.length];
      lyricsSetBtn();
      showToast(`Lyrics speed ${lyricsSpeed}Ã—`);
    });

    lyricsTopBtn?.addEventListener("click", () => {
      if(!lyricsBody) return;
      lyricsBody.scrollTop = 0;
      setLyricsHighlight();
      showToast("Back to top");
    });

    lyricsBody?.addEventListener("wheel", () => { markUserInteracting(); setLyricsHighlight(); }, { passive: true });
    lyricsBody?.addEventListener("touchmove", () => { markUserInteracting(); setLyricsHighlight(); }, { passive: true });
    lyricsBody?.addEventListener("mouseenter", () => { markUserInteracting(); setLyricsHighlight(); });
    lyricsBody?.addEventListener("scroll", () => { markUserInteracting(); setLyricsHighlight(); }, { passive: true });

    window.addEventListener("keydown", (e) => {
      const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : "";
      const typing = tag === "input" || tag === "textarea";
      if(typing) return;

      if(e.key === " "){ e.preventDefault(); storyMode = !storyMode; updateStoryState(); }
      if(e.key.toLowerCase() === "n"){ nextTrack(true); }
      if(e.key.toLowerCase() === "p"){ prevTrack(true); }
      if(e.key.toLowerCase() === "s"){ toggleSaved(); }

      if(e.key === "1"){ scrollToId("about"); }
      if(e.key === "2"){ scrollToId("tracks"); }
      if(e.key === "3"){ scrollToId("home"); }
      if(e.key === "4"){ scrollToId("contact"); }

      if(e.key.toLowerCase() === "r"){ openResume(); }

      if(e.key === "?"){ showToast("Space: story â€¢ N/P: next/prev â€¢ S: save â€¢ R: resume"); }

      if(e.key === "Escape"){
        if(caseDrawer.classList.contains("open")) closeCase();
      }
    });

    const sectionIds = ["about","tracks","home","contact"];
    content.addEventListener("scroll", () => {
      const tops = sectionIds.map(id => {
        const el = document.getElementById(id);
        const r = el.getBoundingClientRect();
        const containerTop = content.getBoundingClientRect().top;
        return { id, dist: Math.abs(r.top - containerTop - 18) };
      });
      tops.sort((a,b) => a.dist - b.dist);
      const activeId = tops[0]?.id;
      if(activeId){
        document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
        const active = document.querySelector(`.nav-item[data-jump="${activeId}"]`);
        if(active) active.classList.add("active");
      }
    });

    // init
    renderPlaylists();
    renderTracks(getVisibleTracks());
    setVolume(volumePct);
    updateStoryState();
    lyricsSetBtn();
    setLyricsHighlight();
    showToast('Loaded. Click a case study to open "Now Playing".');
  </script>
</body>
</html>

